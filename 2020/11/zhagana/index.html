<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Zhagana | Hans Chan&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- hexo-algolia -->
  <meta property="algolia:search" data-application-id="1DJDVE2IL4" data-api-key="c784a416f2e153ae75b1288ed8c3b0d8" data-index-name="BLOG">

  <meta name="description" content="停更了近 3 年，终于又有空写个小文章，关于 Playwright，一个 Microsoft 开源的跨浏览器自动化工具，类似 Puppeteer 的 Chromium + Firefox + WebKit 版。 Step by step guide to use Playwright.">
<meta name="keywords" content="Puppeteer,Headless,Playwright">
<meta property="og:type" content="article">
<meta property="og:title" content="Zhagana">
<meta property="og:url" content="http://blog.csbun.ga/2020/11/zhagana/index.html">
<meta property="og:site_name" content="Hans Chan&#39;s Blog">
<meta property="og:description" content="停更了近 3 年，终于又有空写个小文章，关于 Playwright，一个 Microsoft 开源的跨浏览器自动化工具，类似 Puppeteer 的 Chromium + Firefox + WebKit 版。 Step by step guide to use Playwright.">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/vscode-debuger.png">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/whatsmyuseragent.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/map-chromium-1.png">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/map-webkit-1.png">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/map-webkit-pop.png">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/devtools-map-pop.png">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/devtools-map-pop-button.png">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/devtools-map-pop-off.png">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/devtools-map-search-location.png">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/devtools-map-your-location.png">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/map-chromium-tewo.png">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/devtools-map-search-click.png">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/devtools-map-search-input.png">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/devtools-map-directions.png">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/map-chromium-navigate.png">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/map-webkit-navigate.png">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/map-diff.png">
<meta property="og:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/IMG_4721.jpg">
<meta property="og:updated_time" content="2020-12-04T09:50:53.749Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Zhagana">
<meta name="twitter:description" content="停更了近 3 年，终于又有空写个小文章，关于 Playwright，一个 Microsoft 开源的跨浏览器自动化工具，类似 Puppeteer 的 Chromium + Firefox + WebKit 版。 Step by step guide to use Playwright.">
<meta name="twitter:image" content="https://raw.githubusercontent.com/csbun/zhagana/master/resources/vscode-debuger.png">
  
  
    <link rel="icon" href="favicon.ico">
  
  
 <link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
 <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>


  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  

<!-- Hotjar Tracking Code for csbun.github.io/blog/ -->
<script>
(function(h,o,t,j,a,r){
  h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
  h._hjSettings={hjid:483587,hjsv:5};
  a=o.getElementsByTagName('head')[0];
  r=o.createElement('script');r.async=1;
  r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
  a.appendChild(r);
})(window,document,'//static.hotjar.com/c/hotjar-','.js?sv=');
</script>
<!-- End Hotjar Tracking Code -->

<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-69725995-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
<meta name="google-site-verification" content="w7Jze6jotMvxHSzsNqwEukg5f2L6VNFgRcPZBwBGln8" />


  
  <!-- Google Adsense -->
  <script data-ad-client="ca-pub-6414613701003177" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>
<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo"><i class="logo" style="background-image: url(/css/images/logo.png)"></i><span class="site-title">Hans Chan&#39;s Blog</span></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/.">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
      </nav>
      
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="https://www.gravatar.com/avatar/dc4674b8f674322328c02339cf8da615"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
      
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="http://blog.csbun.ga"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
        
          <td><a class="main-nav-link" href="/.">Home</a></td>
        
          <td><a class="main-nav-link" href="/archives">Archives</a></td>
        
          <td><a class="main-nav-link" href="/tags">Tags</a></td>
        
        <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="http://blog.csbun.ga"></form>
        </td>
      </tr>
    </table>
  </div>
</header>

    <div class="outer">
      
        <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <img id="avatar" src="https://www.gravatar.com/avatar/dc4674b8f674322328c02339cf8da615?s=256">
      <h2 id="name">叉起来就可以烧</h2>
      <h3 id="title">傻逼切图仔</h3>
      <span id="location"><i class="fa fa-map-marker"></i>广州 · Guangzhou, China</span>
      <a id="follow" href="https://github.com/csbun/">FOLLOW</a>
    </div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        41
        <span>posts</span>
      </div>
      <div class="article-info-block">
        67
        <span>tags</span>
      </div>
    </div>
    
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
          
          <td><a href="https://github.com/csbun" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
          
          <td><a href="/atom.xml" target="_blank" title="rss"><i class="fa fa-rss"></i></a></td>
          
        </tr>
      </table>
    </div>
    
    
  </div>
</aside>

      
      <section id="main"><article id="post-zhagana" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      
	
    <div class="article-banner">
		  <img src="/gallery/gannan/IMG_4721.jpg">
    </div>
	


    
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Zhagana
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2020/11/zhagana/">
      <time datetime="2020-11-28T07:09:36.000Z" itemprop="datePublished">2020-11-28</time>
    </a>
  </div>


          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>停更了近 3 年，终于又有空写个小文章，关于 <a href="https://playwright.dev" target="_blank" rel="noopener">Playwright</a>，一个 Microsoft 开源的跨浏览器自动化工具，类似 Puppeteer 的 Chromium + Firefox + WebKit 版。</p>
<p>Step by step guide to use <a href="https://playwright.dev" target="_blank" rel="noopener">Playwright</a>.</p>
<a id="more"></a>
<h2><span id="project-setup">Project Setup</span></h2><p>Create a as simple as we can project manually:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir zhagana</span><br><span class="line"><span class="built_in">cd</span> zhagana</span><br><span class="line">npm init</span><br></pre></td></tr></table></figure>
<p>Install <a href="https://playwright.dev" target="_blank" rel="noopener">Playwright</a> and <a href="https://www.typescriptlang.org" target="_blank" rel="noopener">TypeScript</a> via npm, which may take some minutes to download browser binaries:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i playwright</span><br><span class="line">npm i -D typescript</span><br></pre></td></tr></table></figure>
<h3><span id="typescript-configuration">TypeScript Configuration</span></h3><p>Playwright for JavaScript and TypeScript is generally available. But we still need some configuration for TypeScript. Create a <code>tsconfig.json</code> file with the following content:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"compilerOptions"</span>: &#123;</span><br><span class="line">    <span class="attr">"target"</span>: <span class="string">"es5"</span>,</span><br><span class="line">    <span class="attr">"module"</span>: <span class="string">"commonjs"</span>,</span><br><span class="line">    <span class="attr">"outDir"</span>: <span class="string">"build"</span>,</span><br><span class="line">    <span class="attr">"sourceMap"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="vs-code-launcher-and-debuger">VS Code Launcher and Debuger</span></h3><p>Click the <strong>RUN</strong> button on the left menu then <strong>create a launch.json</strong>. Select <strong>Node.js</strong> from the drop down if you have other debugger extensions.</p>
<p><img src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/vscode-debuger.png" alt="vscode-debuger"></p>
<p>Make sure you have <code>&quot;preLaunchTask&quot;: &quot;tsc: build - tsconfig.json&quot;</code> and <code>&quot;outFiles&quot;: [&quot;${workspaceFolder}/build/**/*.js&quot;]</code> in <em>launch.json</em>.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"0.2.0"</span>,</span><br><span class="line">  <span class="attr">"configurations"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"node"</span>,</span><br><span class="line">      <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"Launch Program"</span>,</span><br><span class="line">      <span class="attr">"skipFiles"</span>: [</span><br><span class="line">        <span class="string">"&lt;node_internals&gt;/**"</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"program"</span>: <span class="string">"$&#123;workspaceFolder&#125;/index.ts"</span>,</span><br><span class="line">      <span class="attr">"preLaunchTask"</span>: <span class="string">"tsc: build - tsconfig.json"</span>,</span><br><span class="line">      <span class="attr">"outFiles"</span>: [<span class="string">"$&#123;workspaceFolder&#125;/build/**/*.js"</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2><span id="coding">Coding</span></h2><h3><span id="screenshot">Screenshot</span></h3><p>We will start by taking a screenshot of the page. This is code <a href="https://playwright.dev/#version=v1.5.1&amp;path=docs%2Fintro.md&amp;q=first-script" target="_blank" rel="noopener">from their documentation</a>, but transfer into TypeScript</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; webkit &#125; <span class="keyword">from</span> <span class="string">'playwright'</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> browser = <span class="keyword">await</span> webkit.launch();</span><br><span class="line">  <span class="keyword">const</span> page = <span class="keyword">await</span> browser.newPage();</span><br><span class="line">  <span class="keyword">await</span> page.goto(<span class="string">'http://whatsmyuseragent.org/'</span>);</span><br><span class="line">  <span class="keyword">await</span> page.screenshot(&#123; path: <span class="string">`out/whatsmyuseragent.png`</span> &#125;);</span><br><span class="line">  <span class="keyword">await</span> browser.close();</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>Press <code>F5</code> to run our project, and we will get the <em>out/whatsmyuseragent.png</em> file like this</p>
<p><img src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/whatsmyuseragent.jpg" alt="whatsmyuseragent"></p>
<p>Now, let’s make it happen in 3 browsers:</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Browser, BrowserType, chromium, firefox, webkit &#125; <span class="keyword">from</span> <span class="string">'playwright'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">screenshot</span>(<span class="params">browserType: BrowserType&lt;Browser&gt;</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// use `browserType` from arguments instead of hardcode</span></span><br><span class="line">  <span class="keyword">const</span> browser = <span class="keyword">await</span> browserType.launch();</span><br><span class="line">  <span class="keyword">const</span> page = <span class="keyword">await</span> browser.newPage();</span><br><span class="line">  <span class="keyword">await</span> page.goto(<span class="string">'http://whatsmyuseragent.org/'</span>);</span><br><span class="line">  <span class="keyword">await</span> page.screenshot(&#123; path: <span class="string">`out/ua-<span class="subst">$&#123;browserType.name()&#125;</span>.png`</span> &#125;);</span><br><span class="line">  <span class="keyword">await</span> browser.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="comment">// 3 different kind of browsers</span></span><br><span class="line">  <span class="keyword">const</span> BROWSER_TYPES = [</span><br><span class="line">    chromium,</span><br><span class="line">    firefox,</span><br><span class="line">    webkit</span><br><span class="line">  ]</span><br><span class="line">  <span class="comment">// make screenshot all together</span></span><br><span class="line">  <span class="keyword">await</span> <span class="built_in">Promise</span>.all(BROWSER_TYPES.map(<span class="function">(<span class="params">browserType</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> screenshot(browserType);</span><br><span class="line">  &#125;));</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>Here we use the <code>screenshot</code> function to take the place of main function and use <code>Promise.all</code> to handle 3 browsers in parallel. After a few seconds, we will get 3 screenshots:</p>
<ul>
<li><em>out/ua-chromium.png</em> with <code>HeadlessChrome</code></li>
<li><em>out/ua-firefox.png</em> with <code>Firefox</code></li>
<li><em>out/ua-webkit.png</em> with <code>AppleWebKit ... Safari</code></li>
</ul>
<h3><span id="emulation-mobile-device">Emulation - Mobile Device</span></h3><p>Next step, we will simulate browser behavior on a mobile device and navigate to <a href="https://www.google.com/maps" target="_blank" rel="noopener">Google Maps</a>.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Browser, BrowserType, devices, chromium, firefox, webkit &#125; <span class="keyword">from</span> <span class="string">'playwright'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">screenshot</span>(<span class="params">browserType: BrowserType&lt;Browser&gt;</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// use `browserType` from arguments instead of hardcode</span></span><br><span class="line">  <span class="keyword">const</span> browser = <span class="keyword">await</span> browserType.launch();</span><br><span class="line">  <span class="comment">// simulate browser behavior on a mobile device</span></span><br><span class="line">  <span class="keyword">const</span> iphone = devices[<span class="string">'iPhone X'</span>];</span><br><span class="line">  <span class="keyword">const</span> context = <span class="keyword">await</span> browser.newContext(&#123; ...iphone &#125;);</span><br><span class="line">  <span class="comment">// open web page</span></span><br><span class="line">  <span class="keyword">const</span> page = <span class="keyword">await</span> context.newPage();</span><br><span class="line">  <span class="keyword">await</span> page.goto(<span class="string">'https://www.google.com/maps'</span>);  </span><br><span class="line">  <span class="comment">// take screenshot</span></span><br><span class="line">  <span class="keyword">await</span> page.screenshot(&#123; path: <span class="string">`out/map-<span class="subst">$&#123;browserType.name()&#125;</span>.png`</span> &#125;);</span><br><span class="line">  <span class="keyword">await</span> browser.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Since firefox does not support mobile, we reduce our browsers to chromium and webkit only:</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="comment">// firefox does not support mobile</span></span><br><span class="line">  <span class="keyword">const</span> BROWSER_TYPES = [ chromium, webkit ]</span><br><span class="line">  <span class="comment">// make screenshot all together</span></span><br><span class="line">  <span class="keyword">await</span> <span class="built_in">Promise</span>.all(BROWSER_TYPES.map(<span class="function">(<span class="params">browserType</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> screenshot(browserType);</span><br><span class="line">  &#125;));</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p><code>F5</code> again we will get 2 <em>png</em> file in <em>out</em> directory:</p>
<table>
<thead>
<tr>
<th style="text-align:center">chromium</th>
<th style="text-align:center">webkit</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/map-chromium-1.png" alt="chromium"></td>
<td style="text-align:center"><img src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/map-webkit-1.png" alt="webkit"></td>
</tr>
</tbody>
</table>
<p>Maps came out, but seems not complete loaded. So we need <code>.waitForNavigation()</code> after <code>page.goto()</code>:</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> page.goto(<span class="string">'https://www.google.com/maps'</span>);</span><br><span class="line"><span class="keyword">await</span> page.waitForNavigation();</span><br><span class="line"><span class="keyword">await</span> page.screenshot(&#123; path: <span class="string">`out/map-<span class="subst">$&#123;browserType.name()&#125;</span>.png`</span> &#125;);</span><br></pre></td></tr></table></figure>
<p>But, wait… there is a blocker comes up: Google Maps want us to download App but we just want to <strong>STAY ON WEB</strong>.</p>
<p><img alt="webkit" src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/map-webkit-pop.png" width="300px"></p>
<h3><span id="input-mouse-click">Input - Mouse Click</span></h3><p>From devtools we can get the selector of this promo: <code>.ml-promotion-nonlu-blocking-promo</code>, use <code>page.waitForSelector()</code> instead of <code>page.waitForNavigation()</code> to catch the promotion:</p>
<p><img src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/devtools-map-pop.png" alt="Devtools - Pop"></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> page.goto(<span class="string">'https://www.google.com/maps'</span>);</span><br><span class="line"><span class="keyword">await</span> page.waitForSelector(<span class="string">'.ml-promotion-nonlu-blocking-promo'</span>);</span><br></pre></td></tr></table></figure>
<p>So let’s click the <strong>STAY ON WEB</strong> button on the page! From devtools we can also get the selector of this button: <code>button.ml-promotion-action-button.ml-promotion-no-button</code>, use <code>page.click()</code> to trigger the click event:</p>
<p><img src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/devtools-map-pop-button.png" alt="Devtools - Button"></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// click STAY ON WEB</span></span><br><span class="line"><span class="keyword">await</span> page.click(<span class="string">'button.ml-promotion-action-button.ml-promotion-no-button'</span>);</span><br></pre></td></tr></table></figure>
<p>As the invisible animation last for 0.3s, we need to wait for more than 300ms after button clicked, before we capture the screenshot.</p>
<p><img src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/devtools-map-pop-off.png" alt="Devtools - Pop off"></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// wait for more than 300 millisecond for browser to response with the events</span></span><br><span class="line"><span class="keyword">await</span> page.waitForTimeout(<span class="number">400</span>);</span><br><span class="line"><span class="keyword">await</span> page.screenshot(&#123; path: <span class="string">`out/map-<span class="subst">$&#123;browserType.name</span></span></span><br></pre></td></tr></table></figure>
<h3><span id="emulation-geolocation">Emulation - Geolocation</span></h3><p>Now we have the map in our current location (may be base on IP address) but we also have the ability to simulate to a different place. We can “fly” to town <em>Tewo</em> by<br>reating a context with “geolocation” permissions granted:</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> context = <span class="keyword">await</span> browser.newContext(&#123;</span><br><span class="line">  ...iphone,</span><br><span class="line">  geolocation: &#123;</span><br><span class="line">      longitude: <span class="number">103.2199128</span>,</span><br><span class="line">      latitude: <span class="number">34.0556586</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  permissions: [<span class="string">'geolocation'</span>],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>If you don’t konw the longitude and latitude of your “perfect place”, just search it in Google Maps then you can get it from the browser URL.</p>
<p><img src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/devtools-map-search-location.png" alt="search-location"></p>
<p>Click the <strong>Your Location</strong> button to navigate to our emulated geolocation.</p>
<p><img src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/devtools-map-your-location.png" alt="Your Location"></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// click `your location` to navi to current location</span></span><br><span class="line"><span class="keyword">await</span> page.click(<span class="string">'button.ml-button-my-location-fab'</span>);</span><br><span class="line"><span class="comment">// As I can not find any event which means relocat finished,</span></span><br><span class="line"><span class="comment">// so we need to wait for some seconds for Google Maps to load resources</span></span><br><span class="line"><span class="keyword">await</span> page.waitForTimeout(<span class="number">500</span>);</span><br></pre></td></tr></table></figure>
<p>Re-run our project we will find us located in <em>Tewo Post Bureau</em>.</p>
<p><img alt="Tewo" src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/map-chromium-tewo.png" width="300px"></p>
<h3><span id="input-text-input">Input - Text Input</span></h3><p>After these simulations, we can start to control the page with more playwright APIs, just like what we click the page just now.</p>
<p>First, fill in the search bar with our target place, like <em>Zhagana</em>.</p>
<p><img src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/devtools-map-search-click.png" alt="Devtools - Click search box"></p>
<p><img src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/devtools-map-search-input.png" alt="Devtools - Search box input"></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> page.click(<span class="string">'div.ml-searchbox-button-textarea'</span>);</span><br><span class="line"><span class="keyword">await</span> page.waitForSelector(<span class="string">'#ml-searchboxinput'</span>);</span><br><span class="line"><span class="comment">// fill in content</span></span><br><span class="line"><span class="keyword">await</span> page.fill(<span class="string">'#ml-searchboxinput'</span>, <span class="string">'Zhagana'</span>);</span><br></pre></td></tr></table></figure>
<p>Second, press <code>Enter</code> to search.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// press Enter to start searching</span></span><br><span class="line"><span class="keyword">await</span> page.press(<span class="string">'#ml-searchboxinput'</span>, <span class="string">'Enter'</span>);</span><br></pre></td></tr></table></figure>
<p>After that, we will get the target place with a red point, and there should be a <strong>Directions</strong> button at the bottom of the page.</p>
<p><img src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/devtools-map-directions.png" alt="Devtools - Directions"></p>
<p>Third, click <strong>Directions</strong> and google will provide us the navigation route.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// click Directions</span></span><br><span class="line"><span class="keyword">const</span> directionsSelector = <span class="string">'button[jsaction="pane.placeActions.directions"]'</span></span><br><span class="line"><span class="keyword">await</span> page.waitForSelector(directionsSelector);</span><br><span class="line"><span class="keyword">await</span> page.click(directionsSelector)</span><br></pre></td></tr></table></figure>
<p>Put them all together, with output path string as a result.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">screenshot</span>(<span class="params">browserType: BrowserType&lt;Browser&gt;</span>): <span class="title">Promise</span>&lt;<span class="title">string</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// use `browserType` from arguments instead of hardcode</span></span><br><span class="line">  <span class="keyword">const</span> browser = <span class="keyword">await</span> browserType.launch();</span><br><span class="line">  <span class="comment">// simulate browser behavior on a mobile device</span></span><br><span class="line">  <span class="keyword">const</span> iphone = devices[<span class="string">'iPhone X'</span>]</span><br><span class="line">  <span class="keyword">const</span> context = <span class="keyword">await</span> browser.newContext(&#123;</span><br><span class="line">    ...iphone,</span><br><span class="line">    geolocation: &#123;</span><br><span class="line">      longitude: <span class="number">103.2199128</span>,</span><br><span class="line">      latitude: <span class="number">34.0556586</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    permissions: [<span class="string">'geolocation'</span>],</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// open web page</span></span><br><span class="line">  <span class="keyword">const</span> page = <span class="keyword">await</span> context.newPage();</span><br><span class="line">  <span class="keyword">await</span> page.goto(<span class="string">'https://www.google.com/maps'</span>);</span><br><span class="line">  <span class="comment">// await page.waitForNavigation();</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">await</span> page.waitForSelector(<span class="string">'.ml-promotion-on-screen'</span>);</span><br><span class="line">  <span class="comment">// click STAY ON WEB</span></span><br><span class="line">  <span class="keyword">await</span> page.click(<span class="string">'button.ml-promotion-action-button.ml-promotion-no-button'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// click `your location` to navi to current location</span></span><br><span class="line">  <span class="keyword">await</span> page.click(<span class="string">'button.ml-button-my-location-fab'</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// click to trigger input field</span></span><br><span class="line">  <span class="keyword">await</span> page.click(<span class="string">'div.ml-searchbox-button-textarea'</span>);</span><br><span class="line">  <span class="keyword">await</span> page.waitForSelector(<span class="string">'#ml-searchboxinput'</span>);</span><br><span class="line">  <span class="comment">// fill in content</span></span><br><span class="line">  <span class="keyword">await</span> page.fill(<span class="string">'#ml-searchboxinput'</span>, <span class="string">'Zhagana'</span>);</span><br><span class="line">  <span class="comment">// press Enter to start searching</span></span><br><span class="line">  <span class="keyword">await</span> page.press(<span class="string">'#ml-searchboxinput'</span>, <span class="string">'Enter'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// click Directions</span></span><br><span class="line">  <span class="keyword">const</span> directionsSelector = <span class="string">'button[jsaction="pane.placeActions.directions"]'</span></span><br><span class="line">  <span class="keyword">await</span> page.waitForSelector(directionsSelector);</span><br><span class="line">  <span class="keyword">await</span> page.click(directionsSelector);</span><br><span class="line">  <span class="comment">// wait for result</span></span><br><span class="line">  <span class="comment">// As I can not find any event which means direction finished,</span></span><br><span class="line">  <span class="comment">// so we need to wait for some seconds for Google Maps to load resources</span></span><br><span class="line">  <span class="keyword">await</span> page.waitForTimeout(<span class="number">2000</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// take screenshot, output path string as a result.</span></span><br><span class="line">  <span class="keyword">const</span> outputPath = <span class="string">`out/map-<span class="subst">$&#123;browserType.name()&#125;</span>.png`</span>;</span><br><span class="line">  <span class="keyword">await</span> page.screenshot(&#123; path: outputPath &#125;);</span><br><span class="line">  <span class="keyword">await</span> browser.close();</span><br><span class="line">  <span class="keyword">return</span> outputPath;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Okay! Here comes out the two maps screenshots:</p>
<table>
<thead>
<tr>
<th style="text-align:center">chromium</th>
<th style="text-align:center">webkit</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/map-chromium-navigate.png" alt="chromium"></td>
<td style="text-align:center"><img src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/map-webkit-navigate.png" alt="webkit"></td>
</tr>
</tbody>
</table>
<h3><span id="image-diff">Image Diff</span></h3><p>The 2 screenshots look exactly the same, but we still want to use some tools to check. <a href="https://github.com/mapbox/pixelmatch" target="_blank" rel="noopener">Pixelmatch</a> is a simple and fast JavaScript pixel-level image comparison library. Create a function to compare two file A and B.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">diff</span>(<span class="params">fileA: <span class="built_in">string</span>, fileB: <span class="built_in">string</span></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// read the 2 different PNG file</span></span><br><span class="line">  <span class="keyword">const</span> mapChromium = PNG.sync.read(fs.readFileSync(fileA));</span><br><span class="line">  <span class="keyword">const</span> mapWebkit = PNG.sync.read(fs.readFileSync(fileB));</span><br><span class="line">  <span class="comment">// init the diff image buffer</span></span><br><span class="line">  <span class="keyword">const</span> &#123; width, height &#125; = mapChromium;</span><br><span class="line">  <span class="keyword">const</span> diffImg = <span class="keyword">new</span> PNG(&#123; width, height &#125;);</span><br><span class="line">  <span class="comment">// pixel diff</span></span><br><span class="line">  pixelmatch(</span><br><span class="line">    mapChromium.data,</span><br><span class="line">    mapWebkit.data,</span><br><span class="line">    diffImg.data,</span><br><span class="line">    width,</span><br><span class="line">    height,</span><br><span class="line">    &#123; threshold: <span class="number">0.1</span> &#125;</span><br><span class="line">  );</span><br><span class="line">  <span class="comment">// print out the diff image</span></span><br><span class="line">  fs.writeFileSync(<span class="string">'out/map-diff.png'</span>, PNG.sync.write(diffImg));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>And call this function after we generated the two screenshots:</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> BROWSER_TYPES = [ chromium, webkit ];</span><br><span class="line">  <span class="comment">// make screenshot all together</span></span><br><span class="line">  <span class="keyword">const</span> maps = <span class="keyword">await</span> <span class="built_in">Promise</span>.all(BROWSER_TYPES.map(<span class="function">(<span class="params">browserType</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> screenshot(browserType);</span><br><span class="line">  &#125;));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">await</span> diff(maps[<span class="number">0</span>], maps[<span class="number">1</span>]);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>Bingo! Google Maps did a great job in the two different browser with almost the same behavior. The only different are font weight and also the navigate route weight.</p>
<p><img alt="Maps diff" src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/map-diff.png" width="300px"></p>
<p>All source code can be found in <a href="https://github.com/csbun/zhagana" target="_blank" rel="noopener">Github</a>.</p>
<h2><span id="postscript">Postscript</span></h2><p>Zhagana is a wonderful place in Tiewu County, Gannan (Tibetan Autonomous Prefecture), Gansu province, China. Zhagana means “Rock Box” in Tibetan language, which is fitting as it is surrounded by large rocky spires on all sides.</p>
<p><img src="https://raw.githubusercontent.com/csbun/zhagana/master/resources/IMG_4721.jpg" alt="Zhagana"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.csbun.ga/2020/11/zhagana/" data-id="ckiljxtt200288blwpi7u2l3a" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Headless/">Headless</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Playwright/">Playwright</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Puppeteer/">Puppeteer</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2018/02/workbox/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Workbox 入门</div>
    </a>
  
</nav>


  
</article>


  <section id="comments"></section>

</section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">tag cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Ajax/" style="font-size: 10px;">Ajax</a> <a href="/tags/Android/" style="font-size: 10px;">Android</a> <a href="/tags/Angular/" style="font-size: 20px;">Angular</a> <a href="/tags/Browserify/" style="font-size: 13.33px;">Browserify</a> <a href="/tags/Chrome/" style="font-size: 10px;">Chrome</a> <a href="/tags/CommonJS/" style="font-size: 13.33px;">CommonJS</a> <a href="/tags/DOM/" style="font-size: 10px;">DOM</a> <a href="/tags/Docker/" style="font-size: 16.67px;">Docker</a> <a href="/tags/ES2015/" style="font-size: 13.33px;">ES2015</a> <a href="/tags/Filter/" style="font-size: 10px;">Filter</a> <a href="/tags/Flux/" style="font-size: 13.33px;">Flux</a> <a href="/tags/Fluxxor/" style="font-size: 10px;">Fluxxor</a> <a href="/tags/Headless/" style="font-size: 13.33px;">Headless</a> <a href="/tags/JSON/" style="font-size: 10px;">JSON</a> <a href="/tags/Java/" style="font-size: 10px;">Java</a> <a href="/tags/Karma/" style="font-size: 10px;">Karma</a> <a href="/tags/Meteor/" style="font-size: 10px;">Meteor</a> <a href="/tags/Mutation-Observer/" style="font-size: 10px;">Mutation Observer</a> <a href="/tags/NW-js/" style="font-size: 10px;">NW.js</a> <a href="/tags/Native/" style="font-size: 10px;">Native</a> <a href="/tags/Node/" style="font-size: 16.67px;">Node</a> <a href="/tags/PWA/" style="font-size: 10px;">PWA</a> <a href="/tags/Playwright/" style="font-size: 10px;">Playwright</a> <a href="/tags/Preact/" style="font-size: 13.33px;">Preact</a> <a href="/tags/Puppeteer/" style="font-size: 13.33px;">Puppeteer</a> <a href="/tags/React/" style="font-size: 20px;">React</a> <a href="/tags/RequireJS/" style="font-size: 10px;">RequireJS</a> <a href="/tags/Rollup/" style="font-size: 10px;">Rollup</a> <a href="/tags/Selenium/" style="font-size: 13.33px;">Selenium</a> <a href="/tags/ServiceWorker/" style="font-size: 13.33px;">ServiceWorker</a> <a href="/tags/Stateful/" style="font-size: 10px;">Stateful</a> <a href="/tags/Storybook/" style="font-size: 10px;">Storybook</a> <a href="/tags/Vue/" style="font-size: 10px;">Vue</a> <a href="/tags/Workbox/" style="font-size: 10px;">Workbox</a> <a href="/tags/async/" style="font-size: 13.33px;">async</a> <a href="/tags/ci/" style="font-size: 16.67px;">ci</a> <a href="/tags/contentEditable/" style="font-size: 10px;">contentEditable</a> <a href="/tags/coverage/" style="font-size: 10px;">coverage</a> <a href="/tags/debug/" style="font-size: 10px;">debug</a> <a href="/tags/deserialization/" style="font-size: 10px;">deserialization</a> <a href="/tags/desktop/" style="font-size: 10px;">desktop</a> <a href="/tags/events/" style="font-size: 10px;">events</a> <a href="/tags/generator/" style="font-size: 10px;">generator</a> <a href="/tags/google/" style="font-size: 10px;">google</a> <a href="/tags/install/" style="font-size: 10px;">install</a> <a href="/tags/koa/" style="font-size: 10px;">koa</a> <a href="/tags/less/" style="font-size: 10px;">less</a> <a href="/tags/log/" style="font-size: 10px;">log</a> <a href="/tags/logo/" style="font-size: 10px;">logo</a> <a href="/tags/nightmare/" style="font-size: 10px;">nightmare</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/performance/" style="font-size: 10px;">performance</a> <a href="/tags/permissions/" style="font-size: 10px;">permissions</a> <a href="/tags/publish/" style="font-size: 10px;">publish</a> <a href="/tags/requestAnimationFrame/" style="font-size: 10px;">requestAnimationFrame</a> <a href="/tags/requestIdleCallback/" style="font-size: 10px;">requestIdleCallback</a> <a href="/tags/serialization/" style="font-size: 10px;">serialization</a> <a href="/tags/ssr/" style="font-size: 10px;">ssr</a> <a href="/tags/test/" style="font-size: 20px;">test</a> <a href="/tags/ui/" style="font-size: 10px;">ui</a> <a href="/tags/vue/" style="font-size: 10px;">vue</a> <a href="/tags/webkit/" style="font-size: 10px;">webkit</a> <a href="/tags/webpack/" style="font-size: 13.33px;">webpack</a> <a href="/tags/weex/" style="font-size: 10px;">weex</a> <a href="/tags/美食/" style="font-size: 13.33px;">美食</a> <a href="/tags/风土人情/" style="font-size: 10px;">风土人情</a> <a href="/tags/风景/" style="font-size: 10px;">风景</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">May 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">February 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">recents</h3>
    <div class="widget">
      <ul id="recent-post" class="">
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2020/11/zhagana/" class="thumbnail">
  
    <span style="background-image:url(/gallery/gannan/IMG_4721.jpg)" alt="Zhagana" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"></p>
              <p class="item-title"><a href="/2020/11/zhagana/" class="title">Zhagana</a></p>
              <p class="item-date"><time datetime="2020-11-28T07:09:36.000Z" itemprop="datePublished">2020-11-28</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2018/02/workbox/" class="thumbnail">
  
    <span style="background-image:url(/gallery/taiwan/DSC04075.JPG)" alt="Workbox 入门" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"></p>
              <p class="item-title"><a href="/2018/02/workbox/" class="title">Workbox 入门</a></p>
              <p class="item-date"><time datetime="2018-02-27T09:38:34.000Z" itemprop="datePublished">2018-02-27</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2018/01/preact-code-h/" class="thumbnail">
  
    <span style="background-image:url(/gallery/taiwan/P51001-124945.jpg)" alt="Preact 源码解析 —— h/createElement" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"></p>
              <p class="item-title"><a href="/2018/01/preact-code-h/" class="title">Preact 源码解析 —— h/createElement</a></p>
              <p class="item-date"><time datetime="2018-01-25T12:04:25.000Z" itemprop="datePublished">2018-01-25</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2017/09/puppeteer/" class="thumbnail">
  
    <span style="background-image:url(https://github.com/csbun/thal/raw/master/media/desertious.jpg
)" alt="译文：Puppeteer 与 Chrome Headless —— 从入门到爬虫" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"></p>
              <p class="item-title"><a href="/2017/09/puppeteer/" class="title">译文：Puppeteer 与 Chrome Headless —— 从入门到爬虫</a></p>
              <p class="item-date"><time datetime="2017-08-31T16:14:09.000Z" itemprop="datePublished">2017-09-01</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2017/08/npm-scripts/" class="thumbnail">
  
    <span style="background-image:url(/gallery/sri-lanka/P60417-160040.jpg)" alt="npm scripts 之 publish 和 install" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"></p>
              <p class="item-title"><a href="/2017/08/npm-scripts/" class="title">npm scripts 之 publish 和 install</a></p>
              <p class="item-date"><time datetime="2017-08-24T10:18:32.000Z" itemprop="datePublished">2017-08-24</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
  <!-- Top -->
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <!-- Buy Me a Coffee -->
    <div style="margin: 10px;">
      <style>.bmc-button img{width: 27px !important;margin-bottom: 1px !important;box-shadow: none !important;border: none !important;vertical-align: middle !important;}.bmc-button{line-height: 36px !important;height:37px !important;text-decoration: none !important;display:inline-flex !important;color:#ffffff !important;background-color:#FF813F !important;border-radius: 3px !important;border: 1px solid transparent !important;padding: 0px 9px !important;font-size: 17px !important;letter-spacing:-0.08px !important;box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;margin: 0 auto !important;font-family:'Lato', sans-serif !important;-webkit-box-sizing: border-box !important;box-sizing: border-box !important;-o-transition: 0.3s all linear !important;-webkit-transition: 0.3s all linear !important;-moz-transition: 0.3s all linear !important;-ms-transition: 0.3s all linear !important;transition: 0.3s all linear !important;}.bmc-button:hover, .bmc-button:active, .bmc-button:focus {-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;text-decoration: none !important;box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;opacity: 0.85 !important;color:#ffffff !important;}</style>
      <link href="https://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext" rel="stylesheet">
      <a class="bmc-button" target="_blank" href="https://www.buymeacoffee.com/csbun">
        <img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg" alt="Buy me a coffee"><span style="margin-left:5px">Buy me a coffee</span>
      </a>
    </div>
    <div id="footer-info" class="inner">
      &copy; 2014 - 2020 叉起来就可以烧<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script type="text/javascript">
  (function() {
    const gitalk = new Gitalk({
      clientID: 'c804b99a7d41b2d2cbef',
      clientSecret: '83cfe9d88987685998971477af4d76fa6e01dde0',
      repo: 'blog',
      owner: 'csbun',
      admin: ['csbun'],
      id: location.pathname,      // Ensure uniqueness and length less than 50
      // createIssueManually: true,
      distractionFreeMode: false,  // Facebook-like distraction free mode
    });
    gitalk.render('comments')
  })();
</script>



 <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>




  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

    <script src="//unpkg.com/algolia-search-idd@0.1.0/dest/index.min.js"></script>
<script type="text/javascript">
(function () {
  const algoliaConfig = document.querySelector('meta[property="algolia:search"]').dataset;
  $('.search-form')
    .attr('autocomplete', 'off')
    // .on('submit', function(e) {
    //   e.preventDefault();
    // });
  window.algoliaSearchIDD({
    el: '.search-form-input',
    applicationID: algoliaConfig.applicationId,
    apiKey: algoliaConfig.apiKey,
    indexName: algoliaConfig.indexName,
  });
})()
</script>
  </div>
</body>
</html>
